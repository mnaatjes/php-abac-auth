{
    "policies": [
        {
            "name": "policy_func_starts_with",
            "description": "Permits if actor's name starts with 'Admin'.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["do-admin-stuff"],
            "subjects": ["System"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "startsWith",
                        "arguments": [
                            { "actor_attribute": "name" },
                            { "value": "Admin" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_ends_with",
            "description": "Permits if subject filename ends with '.log'.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["view-log"],
            "subjects": ["File"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "endsWith",
                        "arguments": [
                            { "subject_attribute": "filename" },
                            { "value": ".log" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_is_between",
            "description": "Permits if subject score is between 90 and 100.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["view-score"],
            "subjects": ["TestResult"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "isBetween",
                        "arguments": [
                            { "subject_attribute": "score" },
                            { "value": 90 },
                            { "value": 100 }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_ip_match",
            "description": "Permits if actor's IP matches the environment IP.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["access-internal"],
            "subjects": ["Resource"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "ipMatches",
                        "arguments": [
                            { "actor_attribute": "ipAddress" },
                            { "environment_attribute": "sourceIp" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_is_member_of",
            "description": "Permits if actor's group is a member of the subject's owning group.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["view-resource"],
            "subjects": ["Resource"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "isMemberOf",
                        "arguments": [
                            { "actor_attribute": "group" },
                            { "subject_attribute": "owningGroup" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_has_domain",
            "description": "Permits if actor's email has the specified domain.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["login"],
            "subjects": ["System"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "hasDomain",
                        "arguments": [
                            { "actor_attribute": "email" },
                            { "value": "example.com" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_time_match",
            "description": "Permits if request time is within business hours.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["access-reports"],
            "subjects": ["Report"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "isBusinessHours",
                        "arguments": [
                            { "environment_attribute": "requestTime" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "policy_func_semver_check",
            "description": "Permits if subject version is greater than 2.1.0.",
            "effect": "permit",
            "actors": ["User"],
            "actions": ["use-feature"],
            "subjects": ["Application"],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "function": "semverGreaterThan",
                        "arguments": [
                            { "subject_attribute": "version" },
                            { "value": "2.1.0" }
                        ]
                    }
                ]
            }
        },
        {
            "name": "AllowPostEditingForOwner",
            "description": "Allows users to edit their own posts.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "edit-post",
                "update-post"
            ],
            "subjects": [
                "Post"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "actor_attribute": "id",
                        "operator": "equals",
                        "subject_attribute": "authorId"
                    }
                ]
            }
        },
        {
            "name": "DenyGuestPostViewing",
            "description": "Denies guests from viewing premium posts.",
            "effect": "deny",
            "actors": [
                "User"
            ],
            "actions": [
                "view-post"
            ],
            "subjects": [
                "Post"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "actor_attribute": "role",
                        "operator": "equals",
                        "value": "guest"
                    },
                    {
                        "subject_attribute": "isPremium",
                        "operator": "equals",
                        "value": true
                    }
                ]
            }
        },
        {
            "name": "AllowAdminUniversalRead",
            "description": "Allows users with the 'admin' role to view any resource.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "view-post",
                "view-comment",
                "view-user"
            ],
            "subjects": [
                "Post",
                "Comment",
                "User"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "actor_attribute": "role",
                        "operator": "equals",
                        "value": "admin"
                    }
                ]
            }
        },
        {
            "name": "DenyDeleteOnPublishedArticles",
            "description": "Prevents anyone, including the owner, from deleting an article once it is published.",
            "effect": "deny",
            "actors": [
                "User"
            ],
            "actions": [
                "delete-post"
            ],
            "subjects": [
                "Post"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "subject_attribute": "status",
                        "operator": "equals",
                        "value": "published"
                    }
                ]
            }
        },
        {
            "name": "AllowEditingForEditorsOrAdmins",
            "description": "Allows a user to edit a post if they are an 'editor' OR an 'admin'.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "edit-post"
            ],
            "subjects": [
                "Post"
            ],
            "rules": {
                "condition": "OR",
                "expressions": [
                    {
                        "actor_attribute": "role",
                        "operator": "equals",
                        "value": "editor"
                    },
                    {
                        "actor_attribute": "role",
                        "operator": "equals",
                        "value": "admin"
                    }
                ]
            }
        },
        {
            "name": "DenyAccessOutsideBusinessHours",
            "description": "Denies access to financial reports outside of business hours (9am-5pm).",
            "effect": "deny",
            "actors": [
                "User"
            ],
            "actions": [
                "view-financial-report"
            ],
            "subjects": [
                "FinancialReport"
            ],
            "rules": {
                "condition": "OR",
                "expressions": [
                    {
                        "environment_attribute": "hour",
                        "operator": "lessThan",
                        "value": 9
                    },
                    {
                        "environment_attribute": "hour",
                        "operator": "greaterThan",
                        "value": 17
                    }
                ]
            }
        },
        {
            "name": "AllowAuthorOrReviewerAccess",
            "description": "Permits access to a document if the user is the author or in the list of reviewers.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "view-document"
            ],
            "subjects": [
                "Document"
            ],
            "rules": {
                "condition": "OR",
                "expressions": [
                    {
                        "actor_attribute": "id",
                        "operator": "equals",
                        "subject_attribute": "authorId"
                    },
                    {
                        "actor_attribute": "id",
                        "operator": "in",
                        "subject_attribute": "reviewerIds"
                    }
                ]
            }
        },
        {
            "name": "AllowViewingOfPublishedContent",
            "description": "Permits viewing a subject only if it is published.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "view-post",
                "view-document"
            ],
            "subjects": [
                "Post",
                "Document"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "operator": "isTrue",
                        "subject_attribute": "isPublished"
                    }
                ]
            }
        },
        {
            "name": "DenyActionsOnInactiveUsers",
            "description": "Denies actions performed on users who are not active.",
            "effect": "deny",
            "actors": [
                "User"
            ],
            "actions": [
                "edit-user",
                "delete-user"
            ],
            "subjects": [
                "User"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "operator": "isFalse",
                        "subject_attribute": "isActive"
                    }
                ]
            }
        },
        {
            "name": "RequireDepartmentForReport",
            "description": "A user must have a department to view a financial report.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "view-financial-report"
            ],
            "subjects": [
                "FinancialReport"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "operator": "isNotNull",
                        "actor_attribute": "department"
                    }
                ]
            }
        },
        {
            "name": "DenyAccessToUnassignedUsers",
            "description": "Denies access if a user has a null role.",
            "effect": "deny",
            "actors": [
                "User"
            ],
            "actions": [
                "view-project"
            ],
            "subjects": [
                "Project"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "operator": "isNull",
                        "actor_attribute": "role"
                    }
                ]
            }
        },
        {
            "name": "AllowDeleteOnPostWithNoComments",
            "description": "Permits deleting a post only if its comment list is empty.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "delete-post"
            ],
            "subjects": [
                "Post"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "operator": "isEmpty",
                        "subject_attribute": "commentIds"
                    }
                ]
            }
        },
        {
            "name": "RequireMfaForSecureAction",
            "description": "Permits a secure action only if an MFA timestamp exists in the environment.",
            "effect": "permit",
            "actors": [
                "User"
            ],
            "actions": [
                "view-financial-report"
            ],
            "subjects": [
                "FinancialReport"
            ],
            "rules": {
                "condition": "AND",
                "expressions": [
                    {
                        "operator": "isNotEmpty",
                        "environment_attribute": "mfaTimestamp"
                    }
                ]
            }
        }
    ]
}